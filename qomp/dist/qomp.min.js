(()=>{var g=btoa||(s=>Buffer.from(s).toString("base64")),f=atob||(s=>Buffer.from(s,"base64").toString("utf-8")),m=s=>Promise.resolve().then(s),d=(s,t,e)=>{let n=document.createElement(s);Object.entries(t).forEach(([o,r])=>n.setAttribute(o,r)),e&&n.append(document.createTextNode(e)),document.head.append(n)},p=({link:s,css:t})=>{t.length>0&&d("style",{type:"text/css"},t),s.length>0&&(typeof s=="string"?[s]:s).forEach(n=>d("link",{rel:"stylesheet",href:n}))},h=(s,t)=>t.reduce((e,n)=>e[n],s),a=!1;function i(s,t){let e=Object.assign({elCount:0,importMetaUrl:s,tagName:s.split("/").pop().split(".").shift(),attr:[],props:{},css:()=>"",html:()=>"",update:()=>{},events:()=>[],do:{},style:b,renderClient:E,define:N},t);e.attr.push("subscribe");let n=Object.assign((...o)=>y.apply(e,o),e);return i.tags.push(n),n}i.tags=[];i.styleAll=()=>{let s={link:[],css:""};return i.tags.forEach(t=>{let e=t.style();e.link&&s.link.push(e.link),e.css&&(s.css+=`
`+e.css)}),s};i.defineAll=(s=!0)=>{s&&p(i.styleAll()),i.tags.forEach(t=>{t.define(!1)})};function b(){let s=this,t={};return s.css===!0?t.link=s.importMetaUrl.replace(".js",".css"):t.css=s.css(s.tagName).trim(),t}function y(s="",t={},e=""){let n=this;return n.elCount++,Array.isArray(e)&&(e=e.join(`
`)),`<${n.tagName} ${s} data-props="${g(JSON.stringify(t))}">  ${n.html({props:t}).replace("<slot></slot>",e)}</${n.tagName}>`}function E(s,t={}){let e=this;e.elCount++;let n=e.html({props:t});if(!n.includes("<slot>")){s.innerHTML=n;return}let o=document.createElement("div");[...s.childNodes].filter(l=>l.textContent.trim()).forEach(l=>o.appendChild(l)),s.innerHTML=n;for(let l of[...o.childNodes]){let c=s.querySelector("slot");if(c)c.parentNode.replaceChild(l,c);else{console.warn(e.tagName,s.id,": more children than slots, or maybe bad closing tag");break}}}function N(s=!0){let t=this;a&&t.tagName,s&&p(t.style()),customElements.define(t.tagName,class extends HTMLElement{constructor(){super();let e=this;a&&(t.tagName,e.id),e.mem={props:Object.assign({},t.props),ready:!1,update(){let n=JSON.stringify(e.mem.props);e.mem.propsStr!==n&&(e.mem.propsStr=n,t.update({el:e,props:e.mem.props,set:(o,r)=>{e.querySelector(o).innerHTML=r}}),e.dispatchEvent(new CustomEvent("change",{detail:{...e.mem.props}})))},elEvents:[]},e.do={},Object.entries(t.do).forEach(([n,o])=>{e.do[n]=o.bind(e.mem)})}connectedCallback(){let e=this;if(this.mem.ready){a&&(t.tagName,e.id);return}a&&(t.tagName,e.id),m(()=>{e.dataset.props?(a&&(t.tagName,e.id),Object.assign(e.mem.props,JSON.parse(f(e.dataset.props)))):(a&&(t.tagName,e.id),t.renderClient(e,e.mem.props)),a&&(t.tagName,e.id),e.mem.elEvents=t.events({el:e}),e.mem.elEvents.forEach(([o,r,l])=>{e.querySelector(o).addEventListener(r,l)}),e.mem.ready=!0})}disconnectedCallback(){let e=this;if(e.parentElement){a&&(t.tagName,e.id);return}a&&(t.tagName,e.id),a&&(t.tagName,e.id),e.mem.elEvents.forEach(([n,o,r])=>e.querySelector(n).removeEventListener(o,r)),e.mem.elEvents=[],e.mem.unsubscribe&&e.mem.unsubscribe()}set props(e){let n=this;Object.assign(n.mem.props,e),n.mem.ready&&n.mem.update()}get props(){return{...this.mem.props}}static get observedAttributes(){return t.attr}attributeChangedCallback(e,n,o){let r=this;if(e!=="subscribe"){r.props={[e]:o};return}m(()=>{r.mem.unsubscribe&&r.mem.unsubscribe();let[l,...c]=o.split(".");r.mem.unsubscribe=window[l].subscribe(u=>{r.props=h(u,c)})})}})}})();
